sudo: false
language: ruby
cache: bundler

rvm: 
  - 2.2.8
  - 2.3.5
  - 2.4.2
  - ruby-head

env:
  - POSTGRESQL_VERSION=9.2
  - POSTGRESQL_VERSION=9.3
  - POSTGRESQL_VERSION=9.4
  - POSTGRESQL_VERSION=9.5
  - POSTGRESQL_VERSION=9.6

script: TRAVIS_CI=1 bundle exec rake test

before_install:
  - sudo service postgresql stop && sudo service postgresql start $POSTGRESQL_VERSION

before_script:
  - psql -U postgres -tc 'SHOW server_version'
  - psql -c 'create database pghero_test;' -U postgres

notifications:
  email:
    on_success: never
    on_failure: change
